From 3daea83a112777b56fc4eedf9f83c64a78a9d1a3 Mon Sep 17 00:00:00 2001
From: Philippe Gerum <rpm@xenomai.org>
Date: Mon, 20 Jan 2020 16:51:19 +0100
Subject: [PATCH] clocksource/arm_arch_timer: set vDSO access type
 unconditionally

Signed-off-by: Philippe Gerum <rpm@xenomai.org>
---
 drivers/clocksource/arm_arch_timer.c | 2 --
 1 file changed, 2 deletions(-)

diff --git a/drivers/clocksource/arm_arch_timer.c b/drivers/clocksource/arm_arch_timer.c
index 81c3b7b4988b..c973eabfd1f0 100644
--- a/drivers/clocksource/arm_arch_timer.c
+++ b/drivers/clocksource/arm_arch_timer.c
@@ -985,10 +985,8 @@ static void __init arch_counter_register(unsigned type)
 
 		arch_timer_read_counter = rd;
 		clocksource_counter.archdata.vdso_direct = vdso_default;
-#ifdef CONFIG_GENERIC_CLOCKSOURCE_VDSO
 		if (vdso_default)
 			clocksource_counter.vdso_type = CLOCKSOURCE_VDSO_ARCHITECTED;
-#endif
 	} else {
 		arch_timer_read_counter = arch_counter_get_cntvct_mem;
 	}
-- 
2.16.4

