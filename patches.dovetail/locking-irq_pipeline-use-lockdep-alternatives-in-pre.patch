From 3865d79a64a50123e240fcd864be888fa35cc5f6 Mon Sep 17 00:00:00 2001
From: Philippe Gerum <rpm@xenomai.org>
Date: Thu, 25 Apr 2019 11:30:48 +0200
Subject: [PATCH] locking: irq_pipeline: use lockdep alternatives in predicates

Signed-off-by: Philippe Gerum <rpm@xenomai.org>
---
 include/linux/lockdep.h | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/include/linux/lockdep.h b/include/linux/lockdep.h
index 065b81422d7b..2af5f24ca0a1 100644
--- a/include/linux/lockdep.h
+++ b/include/linux/lockdep.h
@@ -362,8 +362,8 @@ static inline int lock_is_held(const struct lockdep_map *lock)
 	return lock_is_held_type(lock, -1);
 }
 
-#define lockdep_is_held(lock)		lock_is_held(&(lock)->dep_map)
-#define lockdep_is_held_type(lock, r)	lock_is_held_type(&(lock)->dep_map, (r))
+#define lockdep_is_held(lock)		lock_is_held(LOCKDEP_ALTERNATIVES(lock))
+#define lockdep_is_held_type(lock, r)	lock_is_held_type(LOCKDEP_ALTERNATIVES(lock), (r))
 
 extern void lock_set_class(struct lockdep_map *lock, const char *name,
 			   struct lock_class_key *key, unsigned int subclass,
-- 
2.16.4

